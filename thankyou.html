<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmed | AYMODINES</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; --main-green: #22543d; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div id="thank-you-container" class="max-w-lg w-full bg-white p-8 rounded-lg shadow-lg text-center">
        <svg class="w-16 h-16 mx-auto text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
        <h1 class="text-3xl font-bold mt-4">Thank You For Your Order!</h1>
        <p class="text-gray-600 mt-2">Your order has been placed. Please listen for your number to be called.</p>
        
        <div class="my-6 bg-green-50 border-2 border-dashed border-green-200 p-4 rounded-lg">
            <p class="text-lg">Your Order Number is:</p>
            <p id="order-number" class="text-5xl font-bold text-[var(--main-green)]">...</p>
        </div>

        <div id="receipt-details" class="text-left border-t pt-4">
            <h3 class="font-semibold text-lg mb-2">Receipt Summary</h3>
            <!-- Receipt items will be injected here -->
        </div>

        <a href="menu.html" class="inline-block mt-8 text-green-600 hover:underline font-semibold">Place another order</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('thank-you-container');
            const params = new URLSearchParams(window.location.search);
            const orderId = params.get('orderId');
            const lastOrderJSON = sessionStorage.getItem('lastOrder');

            if (!orderId || !lastOrderJSON) {
                container.innerHTML = `
                    <h1 class="text-3xl font-bold text-red-600">Error</h1>
                    <p class="text-gray-700 mt-4">No order details were found. It's possible the session has expired.</p>
                    <a href="menu.html" class="inline-block mt-8 text-green-600 hover:underline font-semibold">Start a new order</a>
                `;
                return;
            }

            try {
                const lastOrder = JSON.parse(lastOrderJSON);
                document.getElementById('order-number').textContent = `#${orderId}`;
                
                const receiptContainer = document.getElementById('receipt-details');
                const itemsHtml = lastOrder.items.map(item => `
                    <div class="flex justify-between text-sm text-gray-700">
                        <span>${item.name} (x${item.quantity})</span>
                        <span>RM ${(item.price * item.quantity).toFixed(2)}</span>
                    </div>
                `).join('');

                receiptContainer.innerHTML += `
                    <div class="space-y-1">
                        ${itemsHtml}
                    </div>
                    <div class="flex justify-between font-bold text-base mt-4 border-t pt-2">
                        <span>Total</span>
                        <span>RM ${lastOrder.total.toFixed(2)}</span>
                    </div>
                `;

                // Clean up session storage after displaying the receipt
                sessionStorage.removeItem('lastOrder');

            } catch (error) {
                console.error("Error parsing order data:", error);
                container.innerHTML = '<h1>Error displaying your receipt.</h1>';
            }
        });
    </script>
</body>
</html>
